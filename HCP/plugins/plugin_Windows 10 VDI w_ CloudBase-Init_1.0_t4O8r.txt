{
  "referenceId": "t4O8r",
  "version": "1.0",
  "name": "Windows 10 VDI w/ CloudBase-Init",
  "license": "EULA",
  "description": null,
  "baseScript": "$content = @'\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n  <settings pass=\"generalize\">\n    <component name=\"Microsoft-Windows-PnpSysprep\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n      <PersistAllDeviceInstalls>true</PersistAllDeviceInstalls>\n    </component>\n  </settings>\n  <settings pass=\"oobeSystem\">\n    <component name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\">\n      <OOBE>\n        <HideEULAPage>true</HideEULAPage>\n        <NetworkLocation>Work</NetworkLocation>\n        <ProtectYourPC>1</ProtectYourPC>\n        <SkipMachineOOBE>true</SkipMachineOOBE>\n        <SkipUserOOBE>true</SkipUserOOBE>\n      </OOBE>\n    </component>\n  </settings>\n  <settings pass=\"specialize\">\n    <component name=\"Microsoft-Windows-Deployment\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n      <RunSynchronous>\n        <RunSynchronousCommand wcm:action=\"add\">\n          <Order>1</Order>\n          <Path>cmd.exe /c \"\"C:\\Program Files\\Cloudbase Solutions\\Cloudbase-Init\\Python\\Scripts\\cloudbase-init.exe\" --config-file \"C:\\Program Files\\Cloudbase Solutions\\Cloudbase-Init\\conf\\cloudbase-init-unattend.conf\" &amp;&amp; exit 1 || exit 2\"</Path>\n          <Description>Run Cloudbase-Init to set the hostname</Description>\n          <WillReboot>OnRequest</WillReboot>\n        </RunSynchronousCommand>\n      </RunSynchronous>\n    </component>\n  </settings>\n</unattend>\n'@\n\nNew-Item 'c:\\opt\\Unattend.xml' -type file -force -value $content\n\nStart-Process -FilePath 'C:\\Windows\\System32\\Sysprep\\sysprep.exe' -ArgumentList '/reboot /oobe /unattend:c:\\opt\\Unattend.xml'",
  "envs": [],
  "scriptArgs": null,
  "scriptLang": "POWERSHELL",
  "timeout": 30
}